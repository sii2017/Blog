# TCP/IP协议族   
## TCP/IP分层管理
TCP/IP协议族里重要的一点就是分层。    
TCP/IP协议族按层次分别分为以下4层：**应用层、传输层、网络层和数据链路层。**   
下图表示TCP/IP模型与OSI模型各层的对照关系。   
![](https://github.com/sii2017/image/blob/master/TCP01.png)  
把TCP/IP层次化是有好处的。   
比如，如果互联网只由一个协议统筹，某个地方需要改变设计时，就必须把所有部分整体替换掉。而分层之后只需把变动的层替换掉即可。把各层之间的接口部分规划好之后，每个层次内部的设计就能够自由改动了。    
而层次化之后，设计也变得相对简单了。处于应用层上的应用可以只考虑分派给自己的任务，而不需要弄清对方在地球上哪个地方、对方的传输路线是怎样的、是否能确保传输送达等问题。    
TCP/IP协议族按照层次由上到下，层层包装。   
最上面的是**应用层**，这里面有http，ftp,等等我们熟悉的协议。   
而第二层则是**传输层**，著名的TCP和UDP协议就在这个层次。   
第三层是**网络层**，IP协议就在这里，它负责对数据加上IP地址和其他的数据以确定传输的目标。   
第四层是**数据链路层**，这个层次为待传送的数据加入一个以太网协议头，并进行CRC编码，为最后的数据传输做准备。   
![](https://github.com/sii2017/image/blob/master/TCP02.png)   
TCP/IP协议族各层的作用如下。   
### 应用层
应用层决定了向用户提供应用服务时通信的活动。  
TCP/IP协议族内预存了各类通用的应用服务。比如，FTP（File Transfer Protocol，文件传输协议）和DNS（Domain Name System，域名系统）服务就是其中两类。   
HTTP协议也处于该层。   
### 传输层
传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。   
在传输层有两个性质不同的协议：TCP（Transmission Control Protocol，传输控制协议）和UDP（User Data Protocol，用户数据报协议）。   
### 网络层（又名网络互连层）
网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径（所谓的传输路线）到达对方计算机，并把数据包传送给对方。    
与对方计算机之间通过多台计算机或网络设备进行传输时，网络层所起的作用就是在众多的选项内选择一条传输路线。    
### 链路层（又名数据链路层，网络接口层）
用来处理连接网络的硬件部分。包括控制操作系统、硬件的设备驱动、NIC（Network Interface Card，网络适配器，即网卡），及光纤等物理可见部分（还包括连接器等一切传输媒介）。硬件上的范畴均在链路层的作用范围之内。    
## TCP/IP通信传输流
利用TCP/IP协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端则往应用层往上走。     
![](https://github.com/sii2017/image/blob/master/TCPIP1.jpg)   
用HTTP举例来说明，首先作为发送端的客户端在应用层（HTTP协议）发出一个想看某个Web页面的HTTP请求。   
接着，为了传输方便，在传输层（TCP协议）把从应用层处收到的数据（HTTP请求报文）进行分割，并在各个报文上打上标记序号及端口号后转发给网络层。    
在网络层（IP协议），增加作为通信目的地的MAC地址后转发给链路层。这样一来，发往网络的通信请求就准备齐全了。   
![](https://github.com/sii2017/image/blob/master/TCPIP2.jpg)     
接收端的服务器在链路层接收到数据，按序往上层发送，一直到应用层。当传输到应用层，才能算真正接收到由客户端发送过来的HTTP请求。    
发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接收端在层与层传输数据时，每经过一层时会把对应的首部消去。     
这种把数据信息包装起来的做法称为封装（encapsulate）。   