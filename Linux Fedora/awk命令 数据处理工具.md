## awk命令 数据处理工具
awk是一个很方便的处理数据的工具。  
相比sed用于处理一整行，awk比较倾向于将一行分成数个数据段进行处理。  
### 基本语法
awk的基本语法如下：   
awk '条件类型1 {动作1} 条件类型2 {动作2} ...' filename   
分开来看，每个支持的动作，可以搭配一个条件类型（可有可无）；可以执行多个类似的动作。   
最后支持读取文件，也支持获取其他命令的input。    
> awk后续的所有动作都是以单引号括住的，单引号是awk命令的固定用法了。所以如果在awk命令中包含printf命令，则要用双引号括住。   
### 不带条件的筛选动作  
通常last能取出前几个登录信息，如下：   
root pts/1 192.168.1.100 Tue Feb 10 11:21 still logged in  
每一列信息用空格隔开。  
但是如果我们不需要所有列的数据，我们可以这么用awk命令。   
```c
last| awk '{print $1 "\t" $3 "\t" $4}'   
```   
其中$加数字，代表着显示第几列，上面显示了1，3，4列。其余的列就不显示了。   
\t则意为显示出来的数据列用tab分隔。   
通常情况下我们也可以选择用空格。   
如果我们选择用字母，也是可以的，分隔的地方就会用字母来填充。  
最终的显示效果如下：   
root 192.168.1.100 Tue   
### awk变量
awk有着一些字符变量，代表特殊的含义。   
NF，代表每一行拥有的字段总数。   
NR，代表所处理的是第几行的数据。   
FS，代表目前的分割字符，默认是空格。   
### 使用awk变量
这个变量直接用在awk命令中，就能自动替换为相关的内容。   
```c
last -n 5| awk '{print $1 "\t lines:" NR "\t colimes: " NF}'   
```  
打印出来的结果是：   
root lines: 1 columes: 10   
root lines: 2 columes: 10   
root lines: 3 columes: 10   
...   
### awk的逻辑运算符  
awk支持条件的判断，所以也会用到相关的逻辑运算符。运算符比较简单，是一些大于小于这种：   
\>，大于；   
<，小于；   
\>=，大于或等于；   
<=，小于或等于；   
==，等于；    
!=，不等于。   
### 带条件的删选动作  
```c
cat /etc/passwd| awk '{FS=":"} $3 < 10 {PRINT $1 "\T" $3}'   
```   
passwd中的数据是以冒号分割的，所以写上FS="："。   
显示出来的内容如下：   
root:x:0:root:/root:/bin/bash   
bin 1  
daemon 2   
...   
可以看到第二第三行是根据我们的要求正确显示的，但是第一行是没有筛选的，这是为什么？   
因为虽然我们定义了FS=":"，但是它在第二行才开始生效。（感觉是什么历史遗留的问题）    
我们需要利用BEGIN关键字来进行预先设置。  
```c
cat /etc/passwd| awk 'BEGIN {FS=":"} $3 < 10 {PRINT $1 "\T" $3}'   
```  
这样，第一行也能正常显示了。   
以上笔记摘自鸟哥私房菜P363。如果需要更详细的内容，可以进行参考。   